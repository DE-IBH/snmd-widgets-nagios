define(["snmd-core/SVGWidget","snmd-core/MQTT","snmd-core/SVGImpl/Gradient"],function(t,s,e){"use strict";var a=function(a,i,r){this.opts={cls:t.srClassOpts(r,"Gradient"),range:r.range,hoffset:r.hoffset,hscale:r.hscale,coords:r.coords},"undefined"==typeof r.keys?this.opts.keys=[r.key]:this.opts.keys=r.keys,this.last=[],this.states=[],this.tmap=[];var o;for(o in r.stops){this.last[o]={};var h;for(h=0;h<r.stops[o].length;h++){var p=r.stops[o][h];"undefined"==typeof this.tmap[p]&&(this.tmap[p]=[]),this.tmap[p].indexOf(o)===-1&&this.tmap[p].push(o),this.last[o][p]=void 0}}this.opts.stops=Object.keys(this.last),this.grad=new e(a,i,this.opts),this.tmap.forEach(function(t){s.srRegisterTopic(t,this)},this)};return a.prototype.handleUpdate=function(t,s){var e;try{e=JSON.parse(s)}catch(t){return void console.error("JSON error in performance data: "+t.message)}var a;for(a=0;a<this.tmap[t].length;a++)this.last[this.tmap[t][a]][t]=void 0;var i=0,r=!1;try{this.states[t]=e.state;for(a in this.opts.keys)if("undefined"!=typeof e.perf_data[this.opts.keys[a]]){i=parseFloat(e.perf_data[this.opts.keys[a]].val);break}for(a=0;a<this.tmap[t].length;a++)this.last[this.tmap[t][a]][t]!==i&&(this.last[this.tmap[t][a]][t]=i,r=!0)}catch(s){console.error("Error to process performance data ["+t+"]: "+s.message)}if(r!==!1){var o,h=0,p=[];for(o in this.last){i=0;var t,n=!0;for(t in this.last[o]){var f=parseFloat(this.last[o][t]);isNaN(f)&&(f=0,n=!1),i+=f,h=Math.max(h,this.states[t])}i/=Object.keys(this.last[o]).length,i<this.opts.range[0]&&(i=this.opts.range[0]),i>this.opts.range[1]&&(i=this.opts.range[1]),p[o]=n?(this.opts.hoffset+(i-this.opts.range[0])*this.opts.hscale/(this.opts.range[1]-this.opts.range[0]))%360:void 0}this.grad.update(p,h)}},a});
//# sourceMappingURL=dist/Gradient-PerfData.min.map