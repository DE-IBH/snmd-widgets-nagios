define(["snmd-core/SVGWidget","snmd-core/MQTT","snmd-core/SVGImpl/Gradient","js-logger"],function(t,s,a,e){"use strict";var i=function(e,i,r){this.opts={cls:t.srClassOpts(r,"Gradient"),range:r.range,hoffset:r.hoffset,hscale:r.hscale,coords:r.coords},"undefined"==typeof r.keys?this.opts.keys=[r.key]:this.opts.keys=r.keys,this.last=[],this.states=[],this.tmap=[];var o;for(o in r.stops){this.last[o]={};var h;for(h=0;h<r.stops[o].length;h++){var p=r.stops[o][h];"undefined"==typeof this.tmap[p]&&(this.tmap[p]=[]),this.tmap[p].indexOf(o)===-1&&this.tmap[p].push(o),this.last[o][p]=void 0}}this.opts.stops=Object.keys(this.last),this.grad=new a(e,i,this.opts),Object.keys(this.tmap).forEach(function(t){s.srRegisterTopic(t,this)},this)};return i.prototype.handleUpdate=function(t,s){var a;try{a=JSON.parse(s)}catch(t){return void e.debug("[Nagios/Gradient-PerfData] JSON error in performance data: "+t.message)}var i;for(i=0;i<this.tmap[t].length;i++)this.last[this.tmap[t][i]][t]=void 0;var r=0,o=!1;try{this.states[t]=a.state;for(i in this.opts.keys)if("undefined"!=typeof a.perf_data[this.opts.keys[i]]){r=parseFloat(a.perf_data[this.opts.keys[i]].val);break}for(i=0;i<this.tmap[t].length;i++)this.last[this.tmap[t][i]][t]!==r&&(this.last[this.tmap[t][i]][t]=r,o=!0)}catch(s){e.debug("[Nagios/Gradient-PerfData] Error processing performance data ["+t+"]: "+s.message)}if(o!==!1){var h,p=0,n=[];for(h in this.last){r=0;var f,d=!0;for(f in this.last[h]){var c=parseFloat(this.last[h][f]);isNaN(c)&&(c=0,d=!1),r+=c,p=Math.max(p,this.states[f])}r/=Object.keys(this.last[h]).length,r<this.opts.range[0]&&(r=this.opts.range[0]),r>this.opts.range[1]&&(r=this.opts.range[1]),n[h]=d?(this.opts.hoffset+(r-this.opts.range[0])*this.opts.hscale/(this.opts.range[1]-this.opts.range[0]))%360:void 0}this.grad.update(n,p)}},i});
//# sourceMappingURL=dist/Gradient-PerfData.map