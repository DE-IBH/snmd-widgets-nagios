(function($){"use strict";var NagGrdPerfData=function(root,svg,desc){this.opts={cls:Scotty.SVGWidget.srClassOpts(desc,"Gradient"),range:desc.range,hoffset:desc.hoffset,hscale:desc.hscale,coords:desc.coords};if(typeof desc.keys==="undefined"){this.opts.keys=[desc.key]}else{this.opts.keys=desc.keys}this.last={};this.states={};this.tmap={};for(var stop in desc.stops){this.last[stop]={};for(var t=0;t<desc.stops[stop].length;t++){var topic=desc.stops[stop][t];if(typeof this.tmap[topic]==="undefined"){this.tmap[topic]=[]}if(this.tmap[topic].indexOf(stop)==-1){this.tmap[topic].push(stop)}this.last[stop][topic]=undefined}}this.opts.stops=Object.keys(this.last);this.grad=new(Scotty.SVGWidget.srLookupImpl("Gradient"))(root,svg,this.opts);for(var topic in this.tmap){Scotty.MQTT.srRegisterTopic(topic,this)}};NagGrdPerfData.prototype.handleUpdate=function(topic,msg){var json;try{json=JSON.parse(msg)}catch(err){console.error("JSON error in performance data: "+err.message);return}for(var i=0;i<this.tmap[topic].length;i++){this.last[this.tmap[topic][i]][topic]=val}var val=0;var changed=false;try{this.states[topic]=json.state;for(var i in this.opts.keys){if(typeof json.perf_data[this.opts.keys[i]]!=="undefined"){val=parseFloat(json.perf_data[this.opts.keys[i]].val);break}}for(var i=0;i<this.tmap[topic].length;i++){if(this.last[this.tmap[topic][i]][topic]!==val){this.last[this.tmap[topic][i]][topic]=val;changed=true}}}catch(err){console.error("Error to process performance data ["+topic+"]: "+err.message)}if(changed===false){return}var state=0;var stops=[];for(var stop in this.last){var val=0;var ok=true;for(var topic in this.last[stop]){var v=parseFloat(this.last[stop][topic]);if(isNaN(v)){v=0;ok=false}val+=v;state=Math.max(state,this.states[topic])}val/=Object.keys(this.last[stop]).length;if(val<this.opts.range[0]){val=this.opts.range[0]}if(val>this.opts.range[1]){val=this.opts.range[1]}stops[stop]=ok?(this.opts.hoffset+(val-this.opts.range[0])*this.opts.hscale/(this.opts.range[1]-this.opts.range[0]))%360:undefined}this.grad.update(stops,state)};Scotty.SVGWidget.srRegisterWidget("NagGrdPerfData",NagGrdPerfData)}).call(this,jQuery);(function($){"use strict";var NagTxtPerfMap=function(root,svg,desc){this.opts={desc:desc,cls:Scotty.SVGWidget.srClassOpts(desc,"Text")};this.desc=desc;this.opts.key=desc.key;if(typeof desc.map!=="undefined"){this.opts.map=desc.map}else{this.opts.map={}}if(desc.topics.length!==1){throw"NagTextPerfMap supports a single topic, only!"}this.chart=new(Scotty.SVGWidget.srLookupImpl("Text"))(root,svg,this.opts)};NagTxtPerfMap.prototype.handleUpdate=function(topic,msg){var json;try{json=JSON.parse(msg)}catch(err){console.error("JSON error in performance data: "+err.message);return}try{var val="";if(typeof json.perf_data[this.opts.key]!=="undefined"){val=json.perf_data[this.opts.key].val;if(val in this.opts.map){val=this.opts.map[val]}else{val="?";console.debug("No mapping available ["+topic+"]: "+this.opts.key+" => '"+json.perf_data[this.opts.key].val+"'")}}this.chart.update(val,json.state,false)}catch(err){console.err("Error to process performance data ["+topic+"]: "+err.message)}};Scotty.SVGWidget.srRegisterWidget("NagTxtPerfMap",NagTxtPerfMap)}).call(this,jQuery);(function($){"use strict";var NagStrokePerfData=function(root,svg,desc){this.opts={desc:desc,cls:Scotty.SVGWidget.srClassOpts(desc,"StrokeWidth")};this.desc=desc;if(typeof this.desc.width==="undefined"){this.opts.width=[1,32]}else{this.opts.width=this.desc.width}if(typeof desc.keys==="undefined"){this.opts.keys=[desc.key]}else{this.opts.keys=desc.keys}if(typeof desc.factors==="undefined"){this.opts.factors=[]}else{this.opts.factors=desc.factors}if(typeof desc.factor!=="undefined"){this.opts.factor=parseFloat(desc.factor);if(isNaN(this.opts.factor)){this.opts.factor=1}}else{this.opts.factor=1}if(typeof desc.max!=="undefined"){this.opts.max=parseFloat(desc.max);if(isNaN(this.opts.max)){this.opts.max=100}}else{this.opts.max=100}if(typeof desc.scale!=="undefined"){this.opts.scale=desc.scale}else{this.opts.scale="linear"}this.opts.abs=false;if(typeof desc.abs!=="undefined"){if(desc.abs){this.opts.abs=true}}this.last={};this.factors={};for(var i=0;i<desc.topics.length;i++){this.last[desc.topics[i]]=[];if(typeof this.opts.factors[i]==="undefined"){this.factors[desc.topics[i]]=this.opts.factor}else{this.factors[desc.topics[i]]=this.opts.factors[i]}}this.chart=new(Scotty.SVGWidget.srLookupImpl("StrokeWidth"))(root,svg,this.opts)};NagStrokePerfData.prototype.handleUpdate=function(topic,msg){var json;try{json=JSON.parse(msg)}catch(err){console.error("JSON error in performance data: "+err.message);return}this.last[topic].val=0;try{for(var i=0;i<this.opts.keys.length;i++){if(typeof json.perf_data[this.opts.keys[i]]!=="undefined"){this.last[topic].val+=parseFloat(json.perf_data[this.opts.keys[i]].val)*this.factors[topic]}}this.last[topic].state=json.state}catch(err){console.err("Error to process performance data ["+topic+"]: "+err.message)}var val=0;var state=0;for(var t in this.last){var v=parseFloat(this.last[t].val);if(isNaN(v)){v=0}val+=v;state=Math.max(state,this.last[t].state)}this.chart.update(val,state)};Scotty.SVGWidget.srRegisterWidget("NagStrokePerfData",NagStrokePerfData)}).call(this,jQuery);(function($){"use strict";var NagGaugePerfData=function(root,svg,desc){this.opts={axis:[{max:50,scale:"linear"}],stroke:"yellow",fill:"white",desc:desc,dpi:60/5/60,cls:Scotty.SVGWidget.srClassOpts(desc,"Gauge")};this.desc=desc;if(typeof this.desc.uom==="undefined"){this.opts.uom=""}else{this.opts.uom=this.desc.uom}if(typeof desc.keys==="undefined"){this.opts.keys=[desc.key]}else{this.opts.keys=desc.keys}if(typeof desc.factor!=="undefined"){this.opts.factor=desc.factor}else{this.opts.factor=1}this.last={};for(var i=0;i<desc.topics.length;i++){this.last[desc.topics[i]]=[]}this.max=typeof desc.max==="undefined"?100:desc.max;this.chart=new(Scotty.SVGWidget.srLookupImpl("Gauge"))(root,svg,this.opts)};NagGaugePerfData.prototype.handleUpdate=function(topic,msg){var json;try{json=JSON.parse(msg)}catch(err){console.error("JSON error in performance data: "+err.message);return}this.last[topic].val=0;this.last[topic].state=0;try{for(var i=0;i<this.opts.keys.length;i++){if(typeof json.perf_data[this.opts.keys[i]]!=="undefined"){this.last[topic].val+=parseFloat(json.perf_data[this.opts.keys[i]].val)}}this.last[topic].state=json.state}catch(err){console.warn("Error to process performance data: "+err.message)}var val=0;var state=0;for(var t in this.last){var v=parseFloat(this.last[t].val);if(isNaN(v)){v=0}val+=v;state=Math.max(state,this.last[t].state)}this.chart.update(val*this.opts.factor,this.max,state)};Scotty.SVGWidget.srRegisterWidget("NagGaugePerfData",NagGaugePerfData)}).call(this,jQuery);(function($){"use strict";var NagiosIfPr=function(root,svg,desc){this.opts={axis:[{max:200*1488.096,scale:"linear"}],desc:desc,dpi:60/5/60,cls:Scotty.SVGWidget.srClassOpts(desc,"Chart"),lcls:["snmd-lcl-Nag","snmd-lcl-NagIf","snmd-lcl-NagIfPr"],mcls:["snmd-mcl-Nag","snmd-mcl-NagIf","snmd-mcl-NagIfPr"],tcls:["snmd-tcl-Nag","snmd-tcl-NagIf","snmd-tcl-NagIfPr"]};var max=0;for(var t=0;t<desc.topics.length;t++){var results=new RegExp("Interface (.*Ethernet|POS)").exec(desc.topics[t]);if(results&&results[1]){switch(results[1]){case"TenGigabitEthernet":var m=2e3*97.05;max=m>max?m:max;break;case"GigabitEthernet":var m=200*97.05;max=m>max?m:max;break;case"POS":var m=31*97.05;max=m>max?m:max;break;case"FastEthernet":var m=20*97.05;max=m>max?m:max;break;case"Ethernet":var m=2*97.05;max=m>max?m:max;break;default:var m=this.opts.axis[0].max;max=m>max?m:max;break}}else{max+=this.opts.axis[0].max}}this.opts.axis[0].max=max;if(typeof desc.max!=="undefined"){var m=parseFloat(desc.max);if(!isNaN(m)){this.opts.axis[0].max=m}}this.lines=[{name:"inucast",axis:0,unit:"p"},{name:"outucast",axis:0,unit:"p"}];this.desc=desc;this.last={};for(var t=0;t<desc.topics.length;t++){this.last[desc.topics[t]]=[];for(var i=0;i<this.lines.length;i++){this.last[desc.topics[t]][i]={}}}this.chart=new(Scotty.SVGWidget.srLookupImpl("Chart"))(root,svg,this.opts,this.lines)};NagiosIfPr.prototype.handleUpdate=function(topic,msg){var json;try{json=JSON.parse(msg)}catch(err){console.error("JSON error in performance data: "+err.message);return}for(var i=0;i<this.lines.length;i++){this.last[topic][i].val=0;this.last[topic][i].state=0;try{this.last[topic][i].val=json.perf_data[this.lines[i].name].val}catch(err){}try{this.last[topic][i].state=json.state}catch(err){console.warn("Error to process state data: "+err.message)}}var vals=[];var state=0;for(var i=0;i<this.lines.length;i++){vals[i]=0;for(var t in this.last){var v=parseFloat(this.last[t][i].val);if(isNaN(v)){v=0}vals[i]+=v;state=Math.max(state,this.last[t][i].state)}}this.chart.update(json._timestamp,vals,state)};Scotty.SVGWidget.srRegisterWidget("NagiosIfPr",NagiosIfPr)}).call(this,jQuery);(function($){"use strict";var NagTxtPerfData=function(root,svg,desc){this.opts={desc:desc,cls:Scotty.SVGWidget.srClassOpts(desc,"Text")};this.desc=desc;if(typeof this.desc.uom==="undefined"){this.opts.uom=""}else{this.opts.uom=this.desc.uom}if(typeof desc.keys==="undefined"){this.opts.keys=[desc.key]}else{this.opts.keys=desc.keys}if(typeof desc.factors==="undefined"){this.opts.factors=[]}else{this.opts.factors=desc.factors}if(typeof desc.factor!=="undefined"){this.opts.factor=parseFloat(desc.factor);if(isNaN(this.opts.factor)){this.opts.factor=1}}else{this.opts.factor=1}if(typeof desc.fracts!=="undefined"){this.opts.fracts=desc.fracts}else{this.opts.fracts=1}this.last={};this.factors={};for(var i=0;i<desc.topics.length;i++){this.last[desc.topics[i]]=[];if(typeof this.opts.factors[i]==="undefined"){this.factors[desc.topics[i]]=this.opts.factor}else{this.factors[desc.topics[i]]=this.opts.factors[i]}}this.chart=new(Scotty.SVGWidget.srLookupImpl("Text"))(root,svg,this.opts)};NagTxtPerfData.prototype.handleUpdate=function(topic,msg){var json;try{json=JSON.parse(msg)}catch(err){console.error("JSON error in performance data: "+err.message);return}this.last[topic].val=0;try{for(var i=0;i<this.opts.keys.length;i++){if(typeof json.perf_data[this.opts.keys[i]]!=="undefined"){this.last[topic].val+=parseFloat(json.perf_data[this.opts.keys[i]].val)*this.factors[topic]}}this.last[topic].state=json.state}catch(err){console.err("Error to process performance data ["+topic+"]: "+err.message)}var val=0;var state=0;for(var t in this.last){var v=parseFloat(this.last[t].val);if(isNaN(v)){v=0}val+=v;state=Math.max(state,this.last[t].state)}this.chart.update(val,state)};Scotty.SVGWidget.srRegisterWidget("NagTxtPerfData",NagTxtPerfData)}).call(this,jQuery);(function($){"use strict";var NagClsState=function(root,svg,desc){this.opts={cls:Scotty.SVGWidget.srClassOpts(desc,"Class")};this.last={};for(var i=0;i<desc.topics.length;i++){this.last[desc.topics[i]]=[3]}if(typeof desc.clrsty!=="undefined"){for(var i=0;i<desc.clrsty.length;i++){svg.style[desc.clrsty[i]]=""}}this.el=new(Scotty.SVGWidget.srLookupImpl("Class"))(root,svg,this.opts)};NagClsState.prototype.handleUpdate=function(topic,msg){var json;try{json=JSON.parse(msg)}catch(err){console.error("JSON error in performance data: "+err.message);return}this.last[topic]=undefined;try{this.last[topic]=json.state}catch(err){console.err("Error to process state data ["+topic+"]: "+err.message)}var state=0;for(var t in this.last){state=Math.max(state,this.last[t])}this.el.update(state)};Scotty.SVGWidget.srRegisterWidget("NagClsState",NagClsState)}).call(this,jQuery);(function($){"use strict";var NagiosIfBw=function(root,svg,desc){this.opts={axis:[{max:200*1e6,scale:"linear"}],desc:desc,dpi:60/5/60,cls:Scotty.SVGWidget.srClassOpts(desc,"Chart"),lcls:["snmd-lcl-Nag","snmd-lcl-NagIf","snmd-lcl-NagIfBw"],mcls:["snmd-mcl-Nag","snmd-mcl-NagIf","snmd-mcl-NagIfBw"],tcls:["snmd-tcl-Nag","snmd-tcl-NagIf","snmd-tcl-NagIfBw"]};var max=0;for(var t=0;t<desc.topics.length;t++){var results=new RegExp("Interface (.*Ethernet|POS)").exec(desc.topics[t]);if(results&&results[1]){switch(results[1]){case"TenGigabitEthernet":var m=2e3*1e6;max=m>max?m:max;break;case"GigabitEthernet":var m=200*1e6;max=m>max?m:max;break;case"POS":var m=31*1e6;max=m>max?m:max;break;case"FastEthernet":var m=20*1e6;max=m>max?m:max;break;case"Ethernet":var m=2*1e6;max=m>max?m:max;break;default:var m=this.opts.axis[0].max;max=m>max?m:max;break}}else{max+=this.opts.axis[0].max}}this.opts.axis[0].max=max;if(typeof desc.max!=="undefined"){var m=parseFloat(desc.max);if(!isNaN(m)){this.opts.axis[0].max=m}}this.lines=[{name:"in",axis:0,unit:"b"},{name:"out",axis:0,unit:"b"}];this.desc=desc;this.last={};for(var t=0;t<desc.topics.length;t++){this.last[desc.topics[t]]=[];for(var i=0;i<this.lines.length;i++){this.last[desc.topics[t]][i]={}}}this.chart=new(Scotty.SVGWidget.srLookupImpl("Chart"))(root,svg,this.opts,this.lines)};NagiosIfBw.prototype.handleUpdate=function(topic,msg){var json;try{json=JSON.parse(msg)}catch(err){console.error("JSON error in performance data: "+err.message);return}for(var i=0;i<this.lines.length;i++){this.last[topic][i].val=0;this.last[topic][i].state=0;try{this.last[topic][i].val=json.perf_data[this.lines[i].name].val*8}catch(err){}try{this.last[topic][i].state=json.state}catch(err){console.warn("Error to process state data: "+err.message)}}var vals=[];var state=0;for(var i=0;i<this.lines.length;i++){vals[i]=0;for(var t in this.last){var v=parseFloat(this.last[t][i].val);if(isNaN(v)){v=0}vals[i]+=v;state=Math.max(state,this.last[t][i].state)}}this.chart.update(json._timestamp,vals,state)};Scotty.SVGWidget.srRegisterWidget("NagiosIfBw",NagiosIfBw)}).call(this,jQuery);(function($){"use strict";var NagiosCpuUtil=function(root,svg,desc){this.opts={axis:[{max:100,scale:"linear"}],desc:desc,dpi:60/5/60,cls:Scotty.SVGWidget.srClassOpts(desc,"Chart")};this.lines=[{name:"util",axis:0,unit:"%",style:{stroke:"Orchid",strokeLineCap:"round",strokeLineJoin:"round",strokeWidth:1.5,fill:"Orchid"}}];this.desc=desc;this.last={};for(var i=0;i<desc.topics.length;i++){this.last[desc.topics[i]]=[0,0]}this.chart=new(Scotty.SVGWidget.srLookupImpl("Chart"))(root,svg,this.opts,this.lines)};NagiosCpuUtil.prototype.handleUpdate=function(topic,msg){var json;try{json=JSON.parse(msg)}catch(err){console.error("JSON error in performance data: "+err.message);return}for(var i=0;i<this.lines.length;i++){this.last[topic][i]=0;try{this.last[topic][i]=json.perf_data[this.lines[i].name].val}catch(err){console.warn("Error to process performance data of "+line+": "+err.message)}}var vals=[];for(var i=0;i<this.lines.length;i++){vals[i]=0;var count=0;for(var t in this.last){vals[i]+=parseFloat(this.last[t][i]);count=count+1}vals[i]=vals[i]/count}this.chart.update(json._timestamp,vals)};Scotty.SVGWidget.srRegisterWidget("NagiosCpuUtil",NagiosCpuUtil)}).call(this,jQuery);(function($){"use strict";var NagTxtState=function(root,rsvg,desc){this.opts={cls:Scotty.SVGWidget.srClassOpts(desc,"Class")};this.last={};for(var i=0;i<desc.topics.length;i++){this.last[desc.topics[i]]=[3]}var svg=$(rsvg).children("tspan")[0];if(typeof desc.clrsty!=="undefined"){for(var i=0;i<desc.clrsty.length;i++){svg.style[desc.clrsty[i]]=""}}this.el=new(Scotty.SVGWidget.srLookupImpl("Class"))(root,svg,this.opts)};NagTxtState.prototype.handleUpdate=function(topic,msg){var json;try{json=JSON.parse(msg)}catch(err){console.error("JSON error in performance data: "+err.message);return}this.last[topic]=undefined;try{this.last[topic]=json.state}catch(err){console.err("Error to process state data ["+topic+"]: "+err.message)}var state=0;for(var t in this.last){state=Math.max(state,this.last[t])}this.el.update(state)};Scotty.SVGWidget.srRegisterWidget("NagTxtState",NagTxtState)}).call(this,jQuery);(function($){"use strict";var NagGraphDiskTp=function(root,svg,desc){this.opts={axis:[{max:1e8,scale:"linear"}],fill:"white",desc:desc,dpi:60/5/60,cls:Scotty.SVGWidget.srClassOpts(desc,"Chart"),lcls:["snmd-lcl-Nag","snmd-lcl-NagIO","snmd-lcl-NagIOTp"],mcls:["snmd-mcl-Nag","snmd-mcl-NagIO","snmd-mcl-NagIOTp"],tcls:["snmd-tcl-Nag","snmd-tcl-NagIO","snmd-tcl-NagIOTp"]};this.lines=[{name:"dist_read_throughput",axis:0,unit:"B"},{name:"dist_write_throughput",axis:0,unit:"B"}];this.desc=desc;this.last={};for(var t=0;t<desc.topics.length;t++){this.last[desc.topics[t]]=[];for(var i=0;i<this.lines.length;i++){this.last[desc.topics[t]][i]={}}}this.chart=new(Scotty.SVGWidget.srLookupImpl("Chart"))(root,svg,this.opts,this.lines)};NagGraphDiskTp.prototype.handleUpdate=function(topic,msg){var json;try{json=JSON.parse(msg)}catch(err){console.error("JSON error in performance data: "+err.message);return}for(var i=0;i<this.lines.length;i++){this.last[topic][i].val=0;this.last[topic][i].state=0;try{this.last[topic][i].val=json.perf_data[this.lines[i].name].val;this.last[topic][i].state=json.state}catch(err){console.warn("Error to process performance data of "+this.lines[i].name+": "+err.message)}}var vals=[];var state=0;for(var i=0;i<this.lines.length;i++){vals[i]=0;for(var t in this.last){var v=parseFloat(this.last[t][i].val);if(isNaN(v)){v=0}vals[i]+=v;state=Math.max(state,this.last[t][i].state)}}this.chart.update(json._timestamp,vals,state)};Scotty.SVGWidget.srRegisterWidget("NagGraphDiskTp",NagGraphDiskTp)}).call(this,jQuery);(function($){"use strict";var NagFcBwChart=function(root,svg,desc){this.opts={axis:[{max:100*1e6,scale:"linear"}],desc:desc,dpi:60/5/60,cls:Scotty.SVGWidget.srClassOpts(desc,"Chart"),lcls:["snmd-lcl-Nag","snmd-lcl-NagFc","snmd-lcl-NagFcBw"],mcls:["snmd-mcl-Nag","snmd-mcl-NagFc","snmd-mcl-NagFcBw"],tcls:["snmd-tcl-Nag","snmd-tcl-NagFc","snmd-tcl-NagFcBw"]};var max=0;for(var t=0;t<desc.topics.length;t++){max+=this.opts.axis[0].max}this.opts.axis[0].max=max;if(typeof desc.max!=="undefined"){var m=parseFloat(desc.max);if(!isNaN(m)){this.opts.axis[0].max=m}}this.lines=[{name:"in",axis:0,unit:"B"},{name:"out",axis:0,unit:"B"}];this.desc=desc;this.last={};for(var t=0;t<desc.topics.length;t++){this.last[desc.topics[t]]=[];for(var i=0;i<this.lines.length;i++){this.last[desc.topics[t]][i]={}}}this.chart=new(Scotty.SVGWidget.srLookupImpl("Chart"))(root,svg,this.opts,this.lines)};NagFcBwChart.prototype.handleUpdate=function(topic,msg){var json;try{json=JSON.parse(msg)}catch(err){console.error("JSON error in performance data: "+err.message);return}for(var i=0;i<this.lines.length;i++){this.last[topic][i].val=0;this.last[topic][i].state=0;try{this.last[topic][i].val=json.perf_data[this.lines[i].name].val;this.last[topic][i].state=json.state}catch(err){console.warn("Error to process performance data of "+line+": "+err.message)}}var vals=[];var state=0;for(var i=0;i<this.lines.length;i++){vals[i]=0;for(var t in this.last){var v=parseFloat(this.last[t][i].val);if(isNaN(v)){v=0}vals[i]+=v;state=Math.max(state,this.last[t][i].state)}}this.chart.update(json._timestamp,vals,state)};Scotty.SVGWidget.srRegisterWidget("NagFcBwChart",NagFcBwChart)}).call(this,jQuery);(function($){"use strict";var NagCrtUpsLoad=function(root,svg,desc){this.opts={axis:[{max:50,scale:"linear"}],desc:desc,dpi:60/5/60,cls:Scotty.SVGWidget.srClassOpts(desc,"Chart")};this.lines=[{name:"out_load",axis:0,unit:"%",style:{stroke:"Orchid",strokeLineCap:"round",strokeLineJoin:"round",strokeWidth:1.5,fill:"Orchid"}}];this.desc=desc;this.last={};for(var i=0;i<desc.topics.length;i++){this.last[desc.topics[i]]=[0]}this.chart=new(Scotty.SVGWidget.srLookupImpl("Chart"))(root,svg,this.opts,this.lines)};NagCrtUpsLoad.prototype.handleUpdate=function(topic,msg){var json;try{json=JSON.parse(msg)}catch(err){console.error("JSON error in performance data: "+err.message);return}for(var i=0;i<this.lines.length;i++){this.last[topic][i]=0;try{this.last[topic][i]=json.perf_data[this.lines[i].name].val}catch(err){console.warn("Error to process performance data of "+line+": "+err.message)}}var vals=[];for(var i=0;i<this.lines.length;i++){vals[i]=0;var count=0;for(var t in this.last){vals[i]+=parseFloat(this.last[t][i]);count=count+1}vals[i]=vals[i]/count}this.chart.update(json._timestamp,vals)};Scotty.SVGWidget.srRegisterWidget("NagCrtUpsLoad",NagCrtUpsLoad)}).call(this,jQuery);(function($){"use strict";var NagTrPerfData=function(root,svg,desc){this.opts={desc:desc,cls:Scotty.SVGWidget.srClassOpts(desc,"Transform")};this.desc=desc;if(typeof this.desc.transform==="undefined"){this.opts.transform="scale(%)"}else{this.opts.transform=this.desc.transform}if(typeof desc.keys==="undefined"){this.opts.keys=[desc.key]}else{this.opts.keys=desc.keys}if(typeof desc.factors==="undefined"){this.opts.factors=[]}else{this.opts.factors=desc.factors}if(typeof desc.factor!=="undefined"){this.opts.factor=parseFloat(desc.factor);if(isNaN(this.opts.factor)){this.opts.factor=1}}else{this.opts.factor=1}if(typeof desc.max!=="undefined"){this.opts.max=parseFloat(desc.max);if(isNaN(this.opts.max)){this.opts.max=100}}else{this.opts.max=100}this.last={};this.factors={};for(var i=0;i<desc.topics.length;i++){this.last[desc.topics[i]]=[];if(typeof this.opts.factors[i]==="undefined"){this.factors[desc.topics[i]]=this.opts.factor}else{this.factors[desc.topics[i]]=this.opts.factors[i]}}this.chart=new(Scotty.SVGWidget.srLookupImpl("Transform"))(root,svg,this.opts)};NagTrPerfData.prototype.handleUpdate=function(topic,msg){var json;try{json=JSON.parse(msg)}catch(err){console.error("JSON error in performance data: "+err.message);return}this.last[topic].val=0;try{for(var i=0;i<this.opts.keys.length;i++){if(typeof json.perf_data[this.opts.keys[i]]!=="undefined"){this.last[topic].val+=parseFloat(json.perf_data[this.opts.keys[i]].val)*this.factors[topic]}}this.last[topic].state=json.state}catch(err){console.err("Error to process performance data ["+topic+"]: "+err.message)}var val=0;var state=0;for(var t in this.last){var v=parseFloat(this.last[t].val);if(isNaN(v)){v=0}val+=v;state=Math.max(state,this.last[t].state)}this.chart.update(val,state)};Scotty.SVGWidget.srRegisterWidget("NagTrPerfData",NagTrPerfData)}).call(this,jQuery);
//# sourceMappingURL=dist/snmd-widgets-nagios.min.map