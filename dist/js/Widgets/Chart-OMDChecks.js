define(["snmd-core/js/SVGWidget","snmd-core/js/SVGImpl/Chart","snmd-widgets-nagios/js/Utils","js-logger"],function(s,t,a,e){"use strict";var i=function(e,i,l){if(this.opts={axis:[{max:200,scale:"linear"}],desc:l,dpi:.2,cls:s.srClassOpts(l,"Chart"),lcls:["snmd-lcl-Nag","snmd-lcl-NagOMD","snmd-lcl-NagOMDChecks"],mcls:["snmd-mcl-Nag","snmd-mcl-NagOMD","snmd-mcl-NagOMDChecks"],tcls:["snmd-tcl-Nag","snmd-tcl-NagOMD","snmd-tcl-NagOMDChecks"]},"undefined"!=typeof l.max){var n=parseFloat(l.max);isNaN(n)||(this.opts.axis[0].max=n)}this.lines=[{name:"host_checks",axis:0,unit:"H"},{name:"service_checks",axis:0,unit:"S"}],this.desc=l,this.last=[];var r;for(r=0;r<l.topics.length;r++){this.last[l.topics[r]]=[];var h;for(h=0;h<this.lines.length;h++)this.last[l.topics[r]][h]=[]}this.chart=new t(e,i,this.opts,this.lines,a.qTipConfig(this,"OMD Check Rate",this.lines.map(function(s){return s.name})))};return i.prototype.handleUpdate=function(s,t){var i;try{i=JSON.parse(t)}catch(l){return void e.debug("[Nagios/Chart-OMDChecks] JSON error in performance data: "+l.message)}a.qTipUpdate(i,this);var n;for(n=0;n<this.lines.length;n++){this.last[s][n].val=0,this.last[s][n].state=0;var r=parseFloat(i.perf_data[this.lines[n].name].val);isNaN(r)||(this.last[s][n].val=r);try{this.last[s][n].state=i.state}catch(h){e.debug("[Nagios/Chart-OMDChecks] Error processing state data: "+h.message)}}var c=[],o=0;for(n=0;n<this.lines.length;n++){c[n]=0;var m;for(m in this.last){var d=parseFloat(this.last[m][n].val);isNaN(d)&&(d=0),c[n]+=d,o=Math.max(o,this.last[m][n].state)}}this.chart.update(i._timestamp,c,o)},i});
//# sourceMappingURL=dist/js/Widgets/Chart-OMDChecks.map