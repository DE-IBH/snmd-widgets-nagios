define(["snmd-core/js/SVGWidget","snmd-core/js/SVGImpl/Chart","snmd-widgets-nagios/js/Utils","js-logger"],function(s,t,a,i){"use strict";var e=function(i,e,n){this.opts={title:"FC Port Bandwidth",axis:[{max:1e8,scale:"linear"}],desc:n,dpi:.2,cls:s.srClassOpts(n,"Chart"),lcls:["snmd-lcl-Nag","snmd-lcl-NagFc","snmd-lcl-NagFcBw"],mcls:["snmd-mcl-Nag","snmd-mcl-NagFc","snmd-mcl-NagFcBw"],tcls:["snmd-tcl-Nag","snmd-tcl-NagFc","snmd-tcl-NagFcBw"]};var l,r=0;for(l=0;l<n.topics.length;l++)r+=this.opts.axis[0].max;if(this.opts.axis[0].max=r,void 0!==n.max){var c=parseFloat(n.max);isNaN(c)||(this.opts.axis[0].max=c)}for(this.lines=[{name:"in",axis:0,unit:"B"},{name:"out",axis:0,unit:"B"}],this.desc=n,this.last=[],l=0;l<n.topics.length;l++){this.last[n.topics[l]]=[];var h;for(h=0;h<this.lines.length;h++)this.last[n.topics[l]][h]=[]}this.chart=new t(i,e,this.opts,this.lines,a.qTipConfig(this,this.lines.map(function(s){return s.name})))};return e.prototype.handleUpdate=function(s,t){var e;try{e=JSON.parse(t)}catch(s){return void i.debug("[Nagios/Chart-FcBw] JSON error in performance data: "+s.message)}a.qTipUpdate(s,e,this);var n;for(n=0;n<this.lines.length;n++){this.last[s][n].val=0,this.last[s][n].state=0;try{this.last[s][n].val=e.perf_data[this.lines[n].name].val,this.last[s][n].state=e.state}catch(t){i.debug("[Nagios/Chart-FcBw] Error processing performance data of ["+s+"].line["+n+"]: "+t.message)}}var l=[],r=0;for(n=0;n<this.lines.length;n++){l[n]=0;var c;for(c in this.last){var h=parseFloat(this.last[c][n].val);isNaN(h)&&(h=0),l[n]+=h,r=Math.max(r,this.last[c][n].state)}}this.chart.update(e._timestamp,l,r)},e});