define(["snmd-core/js/SVGWidget","snmd-core/js/MQTT","snmd-core/js/SVGImpl/RadialGradient","js-logger"],function(t,s,a,e){"use strict";var i=function(e,i,r){this.opts={cls:t.srClassOpts(r,"Gradient"),range:r.range,hoffset:r.hoffset,hscale:r.hscale},this.opts.keys="undefined"==typeof r.keys?[r.key]:r.keys,this.last=[],this.states=[],this.tmap=[];var h;for(h in r.stops){this.last[h]={};var o;for(o=0;o<r.stops[h].length;o++){var p=r.stops[h][o];"undefined"==typeof this.tmap[p]&&(this.tmap[p]=[]),-1===this.tmap[p].indexOf(h)&&this.tmap[p].push(h),this.last[h][p]=void 0}}this.opts.stops=Object.keys(this.last),this.grad=new a(e,i,this.opts),Object.keys(this.tmap).forEach(function(t){s.srRegisterTopic(t,this)},this)};return i.prototype.handleUpdate=function(t,s){var a;try{a=JSON.parse(s)}catch(i){return void e.debug("[Nagios/Gradient-PerfData] JSON error in performance data: "+i.message)}var r;for(r=0;r<this.tmap[t].length;r++)this.last[this.tmap[t][r]][t]=void 0;var h=0,o=!1;try{this.states[t]=a.state;for(r in this.opts.keys)if("undefined"!=typeof a.perf_data[this.opts.keys[r]]){h=parseFloat(a.perf_data[this.opts.keys[r]].val);break}for(r=0;r<this.tmap[t].length;r++)this.last[this.tmap[t][r]][t]!==h&&(this.last[this.tmap[t][r]][t]=h,o=!0)}catch(p){e.debug("[Nagios/Gradient-PerfData] Error processing performance data ["+t+"]: "+p.message)}if(o!==!1){var n,f=0,d=[];for(n in this.last){h=0;var l,g=!0;for(l in this.last[n]){var c=parseFloat(this.last[n][l]);isNaN(c)&&(c=0,g=!1),h+=c,f=Math.max(f,this.states[l])}h/=Object.keys(this.last[n]).length,isNaN(h)&&(g=!1),h<this.opts.range[0]&&(h=this.opts.range[0]),h>this.opts.range[1]&&(h=this.opts.range[1]),d[n]=g?(this.opts.hoffset+(h-this.opts.range[0])*this.opts.hscale/(this.opts.range[1]-this.opts.range[0]))%360:void 0}this.grad.update(d,f)}},i});
//# sourceMappingURL=dist/js/RadialGradient-PerfData.map